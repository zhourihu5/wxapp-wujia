<wxs src="../../wxs/utils.wxs" module="utils"/>

<cu-custom style="position: fixed;z-index: 100" isBack="{{true}}">
    <view slot="backText"></view>
    <view slot="content"></view>
</cu-custom>

<view class="container" style="margin-top:{{StatusBar}}px;padding-bottom:calc(98rpx + {{StatusBar}}px) ">
    <!-- wxml -->
    <swiper class='u-wrp-bnr'
            indicator-dots='true' autoplay='true' interval='5000' duration='1000' circular='true'>
        <block wx:for="{{apiData.activity.commodity.attaInfos}}" >
            <swiper-item>
                <image src='{{item.attaAddr}}' class='u-img-slide' mode='aspectFill'></image>
            </swiper-item>
        </block>
    </swiper>
    <view class="item1">
        <view class="price-container">
            <view>
                <text class="dollor">￥</text>
                <text class="price-int">{{utils.numBeforeDot(apiData.activity.price)}}</text>
                <text class="dot" wx:if="{{utils.isNumDot(apiData.activity.price)}}">.</text>
                <text class="price-float">{{utils.numAfterDot(apiData.activity.price)}}</text>
                <text class="line-through price-old">￥{{apiData.activity.commodity.initPrice}}</text>
            </view>
            <text wx:if="{{false}}" class="kaituan-num">10人开团</text>
        </view>

        <view class="item1-r">
            <view class="jlhd">距离活动结束仅剩</view>
            <view>
                <text class="djs">{{hour}}</text>
                <text class="comma">:</text>
                <text class="djs">{{minute}}</text>
                <text class="comma">:</text>
                <text class="djs">{{second}}</text>
            </view>
        </view>
    </view>
    <view class="item2">
        <view class="hdbt">{{apiData.activity.commodity.name}}</view>
        <view class="sell-num">已拼{{apiData.activity.commodity.salesNum}}件</view>
        <view class="flex align-center">
            <text wx:for="{{ utils.strSplitToArr(apiData.activity.commodity.labelsName,'|') }}" wx:for-item="labelItem" wx:key="" class="lable">{{labelItem}}</text>
        </view>
    </view>


    <view class="item3">
        <view class="flex justify-between align-center w-p-100">
            <view class="item3-1">
                <text class="tuan">团</text>
                <text class="mrzgs">每人最高省</text>
                <text class="discount-num">{{apiData.activity.largeMoney}}</text>
                <text class="mrzgs">元</text>
            </view>
            <view class="flex align-center text-underline hdsm" bindtap="showModal">活动说明</view>
        </view>

        <view class="item3-2">
            <view class="cu-avatar-group item3-2-l">
                <image class="cu-avatar round round-image" wx:for="{{apiData.userInfoList}}" wx:key
                      src="{{item.wxCover}}"></image>
            </view>
            <!--                //todo 居于底部-->
            <view class="item-3-2-r">...等{{100}}名用户已参与</view>
        </view>
        <view class="center zlyrctghd">再来{{1}}人参团该活动商品立减
            <text class="lijian">{{6}}</text>
            元
        </view>
    </view>
    <view wx:if="{{false}}" class="item4">
        <view class="tgjd">团购进度</view>
        <view class="step-container">
            <view class="step-selected">1</view>
            <view class="step-selected-text">参与活动</view>
            <view class="dash-line-selected"></view>
            <view class="step-unselected">2</view>
            <view class="step-unselected-text">确认订单</view>
            <view class="dash-line"></view>
            <view class="step-unselected">3</view>
            <view class="step-unselected-text">团购成功</view>
        </view>
    </view>

    <view class="item5">
        <view class="item5-1">商品详情</view>
        <view class="g-form {{index==0?'g-form-b-t':''}}" wx:for="{{formatTitle}}" wx:key >
            <view class="g-f-title">{{item}}</view>
            <view class="g-f-value">{{apiData.activity.commodity.formatVals[index]}}</view>
        </view>
        <view class="{{formatTitle?'p-t-40':''}}"></view>
        <rich-text class="rich-text" nodes="{{  apiData.activity.commodity.infos }}" ></rich-text>
    </view>

</view>

<view class="bottom-button" bindtap="toConfirmOrder" data-id="{{apiData.activity.id}}">去参团</view>

<view class="cu-modal full-screen  {{modalName=='ModalIntro'?'show':''}}">
    <view class="cu-dialog dialog relative">
        <view class="dialog-title">活动说明</view>
        <view class="dialog-content">
            <view>
                <view class="d-c-t">返现支持形式：</view>
                <view class="d-c-c p-b-30">
                    仅限通过“微信支付 ”支付方式付款，给予相应的团购返现；微信卖家“自有微信支付、货到付款、找人代付、送礼”均不支持团购返现。
                </view>
            </view>
            <view>
                <view class="d-c-t">返现方式：</view>
                <view class="d-c-c p-b-30">
                    以部分退款的形式原路返给买家的，满足条件后，就会部分退款相应金额给买家。
                </view>
            </view>
            <view>
                <view class="d-c-t">库存：</view>
                <view class="d-c-c p-b-30">
                    订单退款，已售出件数，不扣除退款订单，不影响满足条件的团购订单返现
                </view>
            </view>
            <view>
                <view class="d-c-t">返现条件：</view>
                <view class="d-c-c p-b-30">
                    卖家可设置售出达到n件，每件返现m元（最低1元，且为整数），最多可设置5条规则；（建议卖家合理设置）
                </view>
            </view>
        </view>
        <view class="dialog-action" bindtap="hideModal">我知道了</view>
    </view>
</view>
